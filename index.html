<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OpenMC-Skins</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
body {
    margin: 0;
    font-family: "Courier New", monospace;
    background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
    color: #fff;
    text-align: center;
}

header {
    background: linear-gradient(90deg, #0ff, #f0f);
    padding: 25px;
    font-size: 2em;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
}

.container {
    max-width: 900px;
    margin: 20px auto;
    padding: 0 10px;
}

#dropzone {
    border: 3px dashed #555;
    background-color: #222;
    padding: 40px;
    border-radius: 12px;
    cursor: pointer;
    transition: 0.2s;
    margin-bottom: 10px;
}
#dropzone.dragover {
    border-color: #0ff;
    background-color: #333;
}
#dropText { font-weight: bold; color: #ccc; }
#success { display: none; color: #0f0; font-weight: bold; margin-top: 10px; }

input, button {
    padding: 10px;
    margin: 5px;
    border-radius: 6px;
    border: none;
    font-weight: bold;
}
input[type="text"] { width: 200px; }
button { background: linear-gradient(90deg,#0ff,#f0f); color: #121212; cursor: pointer; transition: transform 0.1s; }
button:hover { transform: scale(1.05); }

#gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 15px;
    margin-top: 30px;
}
.skin-card {
    background-color: #1a1a1a;
    padding: 10px;
    border-radius: 10px;
    text-align: center;
}
.skin-card img {
    width: 100px;
    height: 100px;
    image-rendering: pixelated;
    border-radius: 5px;
}
.skin-card button {
    margin-top: 5px;
    padding: 5px 10px;
    background: #0ff;
    border: none;
    border-radius: 5px;
    color: #121212;
    font-weight: bold;
    cursor: pointer;
}
footer {
    text-align: center;
    margin: 40px 0 20px 0;
    font-size: 0.8em;
    color: #888;
}
</style>
</head>
<body>

<header>OpenMC-Skins</header>
<div class="container">
    <div id="dropzone">
        <div id="dropText">Drag & Drop oder klicken, um Datei auszuwählen</div>
        <div id="success">✅ Datei ausgewählt: <span id="fileName"></span></div>
        <input type="file" id="fileInput" accept="image/png" hidden>
    </div>

    <input type="text" id="nameInput" placeholder="Name des Skins">
    <button id="uploadBtn">Upload</button>
    <div id="status"></div>

    <div id="gallery"></div>
</div>

<footer>
Diese Seite ist ein Fan-Projekt und steht in keiner offiziellen Verbindung zu Mojang/Microsoft.<br>
Minecraft und Skins sind geistiges Eigentum von Mojang/Microsoft.
</footer>

<script>
const supabaseUrl = "https://iomomoktrjlhqoeoavkb.supabase.co";
const supabaseKey = "sb_publishable_q1BzzFtE0bFieXJtPD6Sng_lZQXC740";
const bucket = "skins";

const supabase = supabase.createClient(supabaseUrl, supabaseKey);

const dropzone = document.getElementById("dropzone");
const fileInput = document.getElementById("fileInput");
const dropText = document.getElementById("dropText");
const success = document.getElementById("success");
const fileNameText = document.getElementById("fileName");
const uploadBtn = document.getElementById("uploadBtn");
const nameInput = document.getElementById("nameInput");
const status = document.getElementById("status");
const gallery = document.getElementById("gallery");

let selectedFile = null;

// Klick um Datei auszuwählen
dropzone.addEventListener("click", () => fileInput.click());

// Drag & Drop Events
dropzone.addEventListener("dragover", e => { e.preventDefault(); dropzone.classList.add("dragover"); });
dropzone.addEventListener("dragleave", e => { dropzone.classList.remove("dragover"); });
dropzone.addEventListener("drop", e => {
    e.preventDefault();
    dropzone.classList.remove("dragover");
    setFile(e.dataTransfer.files[0]);
});

// Datei ausgewählt
fileInput.addEventListener("change", e => setFile(e.target.files[0]));

function setFile(file) {
    if(!file) return;
    selectedFile = file;
    dropText.style.display = "none";
    success.style.display = "block";
    fileNameText.textContent = file.name;
}

// Upload
uploadBtn.addEventListener("click", async () => {
    if(!selectedFile) { alert("Keine Datei ausgewählt!"); return; }

    const fileName = `${Date.now()}_${nameInput.value.trim() || selectedFile.name}`;

    status.textContent = "⬆️ Upload läuft...";

    const { error } = await supabase.storage.from(bucket).upload(fileName, selectedFile);

    if(error){
        status.textContent = "❌ Upload fehlgeschlagen: " + error.message;
        return;
    }

    status.textContent = "✅ Upload erfolgreich!";
    selectedFile = null;
    fileInput.value = "";
    dropText.style.display = "block";
    success.style.display = "none";
    nameInput.value = "";
    loadGallery();
});

// Galerie laden
async function loadGallery(){
    const { data, error } = await supabase.storage.from(bucket).list();
    if(error) return console.error(error);

    gallery.innerHTML = "";
    data.forEach(file => {
        const url = supabase.storage.from(bucket).getPublicUrl(file.name).data.publicUrl;
        const card = document.createElement("div");
        card.className = "skin-card";

        const img = document.createElement("img");
        img.src = url;
        card.appendChild(img);

        const downloadBtn = document.createElement("button");
        downloadBtn.textContent = "Download";
        downloadBtn.onclick = () => window.open(url, "_blank");
        card.appendChild(downloadBtn);

        const title = document.createElement("div");
        title.textContent = file.name;
        card.appendChild(title);

        gallery.appendChild(card);
    });
}

loadGallery();
</script>

</body>
</html>
